<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>易宝支付报文发送页面</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 引入 Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- HTML5 Shiv 和 Respond.js 用于让 IE8 支持 HTML5元素和媒体查询 -->
    <!-- 注意： 如果通过 file://  引入 Respond.js 文件，则该文件无法起效果 -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<h1 class="text-center">易宝支付报文发送接口</h1>
<div class="container bs-docs-container ">
    <div class="row">
        <div class="col-md-12" role="main">
            <div class="panel-body">
                <form class="form-inline">
                    <div class="row">
                        <div class="form-group col-md-4" role="main">
                            <label for="orderId">订单编号</label>
                            <input type="text" class="form-control" id="orderId">
                        </div>
                        <div class="form-group col-md-4">
                            <label for="customsId">货主代码</label>
                            <input type="text" class="form-control" id="customsId">
                        </div>
                        <div class="form-group col-md-4">
                            <label for="deliverId">提运单号</label>
                            <input type="text" class="form-control" id="deliverId">
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-4">
                            <label for="logisticsId">运单编号</label>
                            <input type="text" class="form-control" id="logisticsId">
                        </div>
                        <div class="form-group col-md-4">
                            <label for="startDate">开始日期</label>
                            <input type="date" class="form-control" id="startDate">
                        </div>
                        <div class="form-group col-md-4">
                            <label for="endDate">结束日期</label>
                            <input type="date" class="form-control" id="endDate">
                        </div>
                    </div>
                    <div class="row">
                        <button type="submit" class="btn btn-primary col-md-1" id="query-order">查询</button>
                        <button type="button" class="btn btn-primary col-md-1 col-md-offset-3" id="query-fee">统计手续费
                        </button>
                        <label class="col-md-1 text-center" style="font-size: 180%" id="total-fee">0.0</label>
                        <button type="button" class="btn btn-primary col-md-1 col-md-offset-2" id="send-message">发送报文
                        </button>
                    </div>
                </form>
            </div>
            <div class="bs-docs-section  pre-scrollable" style="max-height: 600px">
                <table class="table table-bordered table-hover" id="orderList">
                    <thead>
                    <tr class="success">
                        <th scope="row" class="col-md-3">订单号</th>
                        <td>货主代码</td>
                        <td>提运单号</td>
                        <td>订单金额</td>
                        <td>报文状态</td>
                        <td>创建时间</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="info">
                        <th scope="row">订单号</th>
                        <td>货主代码</td>
                        <td>提运单号</td>
                        <td>订单金额</td>
                        <td>报文状态</td>
                        <td>创建时间</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


<!-- jQuery (Bootstrap 的 JavaScript 插件需要引入 jQuery) -->
<script src="https://code.jquery.com/jquery.js"></script>
<!-- 包括所有已编译的插件 -->
<script src="js/bootstrap.min.js"></script>
<script>
    //复选框
    $(function () {
        function initTableCheckbox() {
            var $thr = $('table thead tr');
            var $checkAllTh = $('<th><input type="checkbox" id="checkAll" name="checkAll" /></th>');
            /*将全选/反选复选框添加到表头最前，即增加一列*/
            $thr.prepend($checkAllTh);
            /*“全选/反选”复选框*/
            var $checkAll = $thr.find('input');
            $checkAll.click(function (event) {
                /*将所有行的选中状态设成全选框的选中状态*/
                $tbr.find('input').prop('checked', $(this).prop('checked'));
                /*并调整所有选中行的CSS样式*/
                if ($(this).prop('checked')) {
                    $tbr.find('input').parent().parent().addClass('warning');
                } else {
                    $tbr.find('input').parent().parent().removeClass('warning');
                }
                /*阻止向上冒泡，以防再次触发点击操作*/
                event.stopPropagation();
            });
            /*点击全选框所在单元格时也触发全选框的点击操作*/
            $checkAllTh.click(function () {
                $(this).find('input').click();
            });
            var $tbr = $('table tbody tr');
            var $checkItemTd = $('<td><input type="checkbox" name="checkItem" /></td>');
            /*每一行都在最前面插入一个选中复选框的单元格*/
            $tbr.prepend($checkItemTd);
            /*点击每一行的选中复选框时*/
            $tbr.find('input').click(function (event) {
                /*调整选中行的CSS样式*/
                $(this).parent().parent().toggleClass('warning');
                /*如果已经被选中行的行数等于表格的数据行数，将全选框设为选中状态，否则设为未选中状态*/
                $checkAll.prop('checked', $tbr.find('input:checked').length === $tbr.length);
                /*阻止向上冒泡，以防再次触发点击操作*/
                event.stopPropagation();
            });
            /*点击每一行时也触发该行的选中操作*/
            $tbr.click(function () {
                $(this).find('input').click();
            });
        }

        initTableCheckbox();
    });

    $('#query-order').click(function () {
        var $orderId = $('#orderId');
        var $customsId = $('#customsId');
        var $deliverId = $('#deliverId');
        var $logisticsId = $('#logisticsId');
        var $startDate = $('#startDate');
        var $endDate = $('#endDate');
        var $tablebody = $('table tbody');
        $.ajax({
            url: '/listOrder',// 跳转到 action
            type: 'post', // 传输方式
            data: {
                orderId: $orderId.val().trim(),
                customsId: $customsId.val().trim(),
                deliverId: $deliverId.val().trim(),
                logisticsId: $logisticsId.val().trim(),
                startDate: $startDate.val().trim(),// 将开始日期转换成字符串 传给后台
                endDate: $endDate.val().trim()
                // 将结束日期转换成字符串 传给后台
            },
            async: true, // ajax请求是异步的
            cache: false,// 缓存ajax结果
            dataType: 'json',// 接收 数据格式
            success: function (data) {
                $tablebody.find('tr').remove();
                for (var i = 0; i < data.length; i++) {
                    var $tr = "<tr class='info'>" +
                        "<th scope='row'>" + data[i].orderId + "</th>" +
                        "<td>" + data[i].customsId + "</td>" +
                        "<td>" + data[i].deliverId + "</td>" +
                        "<td>" + data[i].amount + "</td>" +
                        "<td>" + data[i].status + "</td>" +
                        "<td>" + data[i].createTime + "</td>" +
                        "</tr>";
                    $tablebody.append($tr)
                }
            },
            error: function (data) {
                alert(data.message)
            }
        })

    })
</script>
</body>
</html>